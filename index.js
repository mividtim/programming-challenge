(function(f){if(typeof exports==="object"&&typeof module!=="undefined"){module.exports=f()}else if(typeof define==="function"&&define.amd){define([],f)}else{var g;if(typeof window!=="undefined"){g=window}else if(typeof global!=="undefined"){g=global}else if(typeof self!=="undefined"){g=self}else{g=this}g.jiboProgrammingChallenge = f()}})(function(){var define,module,exports;return (function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require=="function"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error("Cannot find module '"+o+"'");throw f.code="MODULE_NOT_FOUND",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require=="function"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({1:[function(require,module,exports){
"use strict";
/// <reference path="../typings/index.d.ts" />
const PIXI = require('pixi.js');
const SCREEN_WIDTH = 1280;
const SCREEN_HEIGHT = 720;
const INITIAL_COLS = 20;
const INITIAL_ROWS = 10;
const rowOR_EVEN = 0xee0000;
const rowOR_ODD = 0x333333;
const rowOR_ARcol = 0xeeeeee;
const rowOR_CHECKER = 0x00eeee;
const renderer = new PIXI.WebGLRenderer(SCREEN_WIDTH, SCREEN_HEIGHT);
document.body.appendChild(renderer.view);
// You need to create a root container that will hold the scene you want to draw.
const stage = new PIXI.Container();
renderLoop(stage);
newGame(INITIAL_ROWS, INITIAL_COLS);
function newGame(rows, cols) {
    clearContainer(stage);
    const boardLayout = newBoardLayout(rows, cols);
    console.log(boardLayout);
    const squareSize = Math.min(SCREEN_WIDTH / cols, SCREEN_HEIGHT / rows) * .9;
    const gameBoard = createBoard(boardLayout, squareSize);
    const checker = createChecker(squareSize);
    gameBoard.addChild(checker);
    stage.addChild(gameBoard);
    const checkerPosition = randomPosition(boardLayout);
    checker.position = boardPositionToPixels(boardLayout, squareSize, checkerPosition);
    play(checker, boardLayout, checkerPosition, squareSize);
}
function play(checker, boardLayout, startingPosition, squareSize) {
    const rows = boardLayout.length;
    const cols = boardLayout[0].length;
    checker.position = boardPositionToPixels(boardLayout, squareSize, startingPosition);
    if (startingPosition.x < 0 || startingPosition.x > rows - 1 || startingPosition.y < 0 || startingPosition.y > cols - 1)
        console.log("Fell off the board!", startingPosition.x, startingPosition.y);
    else {
        const direction = boardLayout[startingPosition.x][startingPosition.y];
        let nextPosition;
        switch (direction) {
            case 0 /* Up */:
                nextPosition = new PIXI.Point(startingPosition.x - 1, startingPosition.y);
                break;
            case 2 /* Down */:
                nextPosition = new PIXI.Point(startingPosition.x + 1, startingPosition.y);
                break;
            case 3 /* Left */:
                nextPosition = new PIXI.Point(startingPosition.x, startingPosition.y - 1);
                break;
            case 1 /* Right */:
                nextPosition = new PIXI.Point(startingPosition.x, startingPosition.y + 1);
                break;
        }
        setTimeout((() => play(checker, boardLayout, nextPosition, squareSize)), 500);
    }
}
function newBoardLayout(rows, cols) {
    const boardLayout = [];
    for (let row = 0; row < rows; row++) {
        boardLayout.push([]);
        for (let col = 0; col < cols; col++) {
            const boardPosition = new PIXI.Point(row, col);
            const arcolDirection = Math.floor(Math.random() * 4);
            boardLayout[row].push(arcolDirection);
        }
    }
    return boardLayout;
}
function createBoard(boardLayout, squareSize) {
    const rows = boardLayout.length;
    const cols = boardLayout[0].length;
    const gameBoard = new PIXI.Container();
    gameBoard.position = new PIXI.Point(SCREEN_WIDTH / 2, SCREEN_HEIGHT / 2);
    let even = false;
    gameBoard.removeChildren();
    for (let row = 0; row < rows; row++) {
        for (let col = 0; col < cols; col++) {
            const boardPosition = new PIXI.Point(row, col);
            const square = createSquare(squareSize, even);
            square.position = boardPositionToPixels(boardLayout, squareSize, boardPosition);
            gameBoard.addChild(square);
            square.addChild(createArcol(squareSize, boardLayout[row][col]));
            even = !even;
        }
        if (rows % 2 === 0)
            even = !even;
    }
    return gameBoard;
}
function createSquare(size, even) {
    const square = new PIXI.Graphics();
    square.beginFill(even ? rowOR_EVEN : rowOR_ODD);
    square.drawRect(-size / 2, -size / 2, size, size);
    square.endFill();
    return square;
}
function createArcol(size, direction) {
    const arcol = new PIXI.Graphics();
    arcol.beginFill(rowOR_ARcol);
    arcol.drawRect(-size / 12, -size * .2, size / 6, size * .6);
    arcol.drawPolygon([
        new PIXI.Point(0, -size * .4),
        new PIXI.Point(-size * .25, -size * .1),
        new PIXI.Point(size * .25, -size * .1)
    ]);
    arcol.endFill();
    arcol.rotation = Math.PI / 2 * direction;
    return arcol;
}
function createChecker(size) {
    const checker = new PIXI.Graphics();
    checker.alpha = .75;
    checker.beginFill(rowOR_CHECKER);
    checker.drawCircle(0, 0, size * .3);
    checker.endFill();
    return checker;
}
function boardPositionToPixels(boardLayout, size, boardPosition) {
    return new PIXI.Point((boardPosition.y - boardLayout[0].length / 2) * size, (boardPosition.x - boardLayout.length / 2) * size);
}
function randomPosition(boardLayout) {
    return new PIXI.Point(Math.floor(Math.random() * boardLayout.length), Math.floor(Math.random() * boardLayout[0].length));
}
function clearContainer(container) {
    container.children.forEach(function (child) { child.destroy(); });
}
function renderLoop(stage) {
    // start the timer for the next animation loop
    requestAnimationFrame(() => renderLoop(stage));
    // each frame we spin the bunny around a bit
    // this is the main render call that makes pixi draw your container and its children.
    renderer.render(stage);
}

},{"pixi.js":undefined}]},{},[1])(1)
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm5vZGVfbW9kdWxlcy9icm93c2VyLXBhY2svX3ByZWx1ZGUuanMiLCJzcmMvaW5kZXgudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUE7O0FDQUEsOENBQThDO0FBQzlDLE1BQU8sSUFBSSxXQUFXLFNBQVMsQ0FBQyxDQUFBO0FBRWhDLE1BQU0sWUFBWSxHQUFVLElBQUksQ0FBQTtBQUNoQyxNQUFNLGFBQWEsR0FBVSxHQUFHLENBQUE7QUFDaEMsTUFBTSxZQUFZLEdBQVUsRUFBRSxDQUFBO0FBQzlCLE1BQU0sWUFBWSxHQUFVLEVBQUUsQ0FBQTtBQUM5QixNQUFNLFVBQVUsR0FBVSxRQUFRLENBQUE7QUFDbEMsTUFBTSxTQUFTLEdBQVUsUUFBUSxDQUFBO0FBQ2pDLE1BQU0sV0FBVyxHQUFVLFFBQVEsQ0FBQTtBQUNuQyxNQUFNLGFBQWEsR0FBVSxRQUFRLENBQUE7QUFTckMsTUFBTSxRQUFRLEdBQXNCLElBQUksSUFBSSxDQUFDLGFBQWEsQ0FBQyxZQUFZLEVBQUUsYUFBYSxDQUFDLENBQUE7QUFDdkYsUUFBUSxDQUFDLElBQUksQ0FBQyxXQUFXLENBQUMsUUFBUSxDQUFDLElBQUksQ0FBQyxDQUFBO0FBRXhDLGlGQUFpRjtBQUNqRixNQUFNLEtBQUssR0FBa0IsSUFBSSxJQUFJLENBQUMsU0FBUyxFQUFFLENBQUE7QUFFakQsVUFBVSxDQUFDLEtBQUssQ0FBQyxDQUFBO0FBQ2pCLE9BQU8sQ0FBQyxZQUFZLEVBQUUsWUFBWSxDQUFDLENBQUE7QUFFbkMsaUJBQWlCLElBQVcsRUFBRSxJQUFXO0lBQ3ZDLGNBQWMsQ0FBQyxLQUFLLENBQUMsQ0FBQTtJQUNyQixNQUFNLFdBQVcsR0FBYyxjQUFjLENBQUMsSUFBSSxFQUFFLElBQUksQ0FBQyxDQUFBO0lBQ3pELE9BQU8sQ0FBQyxHQUFHLENBQUMsV0FBVyxDQUFDLENBQUE7SUFDeEIsTUFBTSxVQUFVLEdBQVUsSUFBSSxDQUFDLEdBQUcsQ0FBQyxZQUFZLEdBQUcsSUFBSSxFQUFFLGFBQWEsR0FB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K0JBQStCLFdBQXNCLEVBQUUsSUFBVyxFQUFFLGFBQXdCO0lBQzFGLE1BQU0sQ0FBQyxJQUFJLElBQUksQ0FBQyxLQUFLLENBQ25CLENBQUMsYUFBYSxDQUFDLENBQUMsR0FBRyxXQUFXLENBQUMsQ0FBQyxDQUFDLENBQUMsTUFBTSxHQUFHLENBQUMsQ0FBQyxHQUFHLElBQUksRUFDcEQsQ0FBQyxhQUFhLENBQUMsQ0FBQyxHQUFHLFdBQVcsQ0FBQyxNQUFNLEdBQUcsQ0FBQyxDQUFDLEdBQUcsSUFBSSxDQUNsRCxDQUFBO0FBQ0gsQ0FBQztBQUVELHdCQUF3QixXQUFzQjtJQUM1QyxNQUFNLENBQUMsSUFBSSxJQUFJLENBQUMsS0FBSyxDQUNqQixJQUFJLENBQUMsS0FBSyxDQUFDLElBQUksQ0FBQyxNQUFNLEVBQUUsR0FBRyxXQUFXLENBQUMsTUFBTSxDQUFDLEVBQzlDLElBQUksQ0FBQyxLQUFLLENBQUMsSUFBSSxDQUFDLE1BQU0sRUFBRSxHQUFHLFdBQVcsQ0FBQyxDQUFDLENBQUMsQ0FBQyxNQUFNLENBQUMsQ0FDcEQsQ0FBQTtBQUNILENBQUM7QUFFRCx3QkFBd0IsU0FBd0I7SUFDOUMsU0FBUyxDQUFDLFFBQVEsQ0FBQyxPQUFPLENBQUMsVUFBUyxLQUF3QixJQUFJLEtBQUssQ0FBQyxPQUFPLEVBQUUsQ0FBQSxDQUFDLENBQUMsQ0FBQyxDQUFBO0FBQ3BGLENBQUM7QUFFRCxvQkFBb0IsS0FBb0I7SUFDcEMsOENBQThDO0lBQzlDLHFCQUFxQixDQUFDLE1BQU0sVUFBVSxDQUFDLEtBQUssQ0FBQyxDQUFDLENBQUE7SUFDOUMsNENBQTRDO0lBQzVDLHFGQUFxRjtJQUNyRixRQUFRLENBQUMsTUFBTSxDQUFDLEtBQUssQ0FBQyxDQUFBO0FBQzFCLENBQUMiLCJmaWxlIjoiZ2VuZXJhdGVkLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXNDb250ZW50IjpbIihmdW5jdGlvbiBlKHQsbixyKXtmdW5jdGlvbiBzKG8sdSl7aWYoIW5bb10pe2lmKCF0W29dKXt2YXIgYT10eXBlb2YgcmVxdWlyZT09XCJmdW5jdGlvblwiJiZyZXF1aXJlO2lmKCF1JiZhKXJldHVybiBhKG8sITApO2lmKGkpcmV0dXJuIGkobywhMCk7dmFyIGY9bmV3IEVycm9yKFwiQ2Fubm90IGZpbmQgbW9kdWxlICdcIitvK1wiJ1wiKTt0aHJvdyBmLmNvZGU9XCJNT0RVTEVfTk9UX0ZPVU5EXCIsZn12YXIgbD1uW29dPXtleHBvcnRzOnt9fTt0W29dWzBdLmNhbGwobC5leHBvcnRzLGZ1bmN0aW9uKGUpe3ZhciBuPXRbb11bMV1bZV07cmV0dXJuIHMobj9uOmUpfSxsLGwuZXhwb3J0cyxlLHQsbixyKX1yZXR1cm4gbltvXS5leHBvcnRzfXZhciBpPXR5cGVvZiByZXF1aXJlPT1cImZ1bmN0aW9uXCImJnJlcXVpcmU7Zm9yKHZhciBvPTA7bzxyLmxlbmd0aDtvKyspcyhyW29dKTtyZXR1cm4gc30pIiwiLy8vIDxyZWZlcmVuY2UgcGF0aD1cIi4uL3R5cGluZ3MvaW5kZXguZC50c1wiIC8+XG5pbXBvcnQgUElYSSA9IHJlcXVpcmUoJ3BpeGkuanMnKVxuXG5jb25zdCBTQ1JFRU5fV0lEVEg6bnVtYmVyID0gMTI4MFxuY29uc3QgU0NSRUVOX0hFSUdIVDpudW1iZXIgPSA3MjBcbmNvbnN0IElOSVRJQUxfQ09MUzpudW1iZXIgPSAyMFxuY29uc3QgSU5JVElBTF9ST1dTOm51bWJlciA9IDEwXG5jb25zdCByb3dPUl9FVkVOOm51bWJlciA9IDB4ZWUwMDAwXG5jb25zdCByb3dPUl9PREQ6bnVtYmVyID0gMHgzMzMzMzNcbmNvbnN0IHJvd09SX0FSY29sOm51bWJlciA9IDB4ZWVlZWVlXG5jb25zdCByb3dPUl9DSEVDS0VSOm51bWJlciA9IDB4MDBlZWVlXG5cbmNvbnN0IGVudW0gRElSRUNUSU9OIHtcbiAgVXAgPSAwLFxuICBSaWdodCxcbiAgRG93bixcbiAgTGVmdFxufVxuXG5jb25zdCByZW5kZXJlcjpQSVhJLldlYkdMUmVuZGVyZXIgPSBuZXcgUElYSS5XZWJHTFJlbmRlcmVyKFNDUkVFTl9XSURUSCwgU0NSRUVOX0hFSUdIVClcbmRvY3VtZW50LmJvZHkuYXBwZW5kQ2hpbGQocmVuZGVyZXIudmlldylcblxuLy8gWW91IG5lZWQgdG8gY3JlYXRlIGEgcm9vdCBjb250YWluZXIgdGhhdCB3aWxsIGhvbGQgdGhlIHNjZW5lIHlvdSB3YW50IHRvIGRyYXcuXG5jb25zdCBzdGFnZTpQSVhJLkNvbnRhaW5lciA9IG5ldyBQSVhJLkNvbnRhaW5lcigpXG5cbnJlbmRlckxvb3Aoc3RhZ2UpXG5uZXdHYW1lKElOSVRJQUxfUk9XUywgSU5JVElBTF9DT0xTKVxuXG5mdW5jdGlvbiBuZXdHYW1lKHJvd3M6bnVtYmVyLCBjb2xzOm51bWJlcik6dm9pZCB7XG4gIGNsZWFyQ29udGFpbmVyKHN0YWdlKVxuICBjb25zdCBib2FyZExheW91dDpudW1iZXJbXVtdID0gbmV3Qm9hcmRMYXlvdXQocm93cywgY29scylcbiAgY29uc29sZS5sb2coYm9hcmRMYXlvdXQpXG4gIGNvbnN0IHNxdWFyZVNpemU6bnVtYmVyID0gTWF0aC5taW4oU0NSRUVOX1dJRFRIIC8gY29scywgU0NSRUVOX0hFSUdIVCAvIHJvd3MpICogLjlcbiAgY29uc3QgZ2FtZUJvYXJkOlBJWEkuQ29udGFpbmVyID0gY3JlYXRlQm9hcmQoYm9hcmRMYXlvdXQsIHNxdWFyZVNpemUpXG4gIGNvbnN0IGNoZWNrZXI6UElYSS5EaXNwbGF5T2JqZWN0ID0gY3JlYXRlQ2hlY2tlcihzcXVhcmVTaXplKVxuICBnYW1lQm9hcmQuYWRkQ2hpbGQoY2hlY2tlcilcbiAgc3RhZ2UuYWRkQ2hpbGQoZ2FtZUJvYXJkKVxuICBjb25zdCBjaGVja2VyUG9zaXRpb246UElYSS5Qb2ludCA9IHJhbmRvbVBvc2l0aW9uKGJvYXJkTGF5b3V0KVxuICBjaGVja2VyLnBvc2l0aW9uID0gYm9hcmRQb3NpdGlvblRvUGl4ZWxzKGJvYXJkTGF5b3V0LCBzcXVhcmVTaXplLCBjaGVja2VyUG9zaXRpb24pXG4gIHBsYXkoY2hlY2tlciwgYm9hcmRMYXlvdXQsIGNoZWNrZXJQb3NpdGlvbiwgc3F1YXJlU2l6ZSlcbn1cblxuZnVuY3Rpb24gcGxheShjaGVja2VyOlBJWEkuRGlzcGxheU9iamVjdCwgYm9hcmRMYXlvdXQ6bnVtYmVyW11bXSwgc3RhcnRpbmdQb3NpdGlvbjpQSVhJLlBvaW50LCBzcXVhcmVTaXplOm51bWJlcik6dm9pZCB7XG4gIGNvbnN0IHJvd3M6bnVtYmVyID0gYm9hcmRMYXlvdXQubGVuZ3RoXG4gIGNvbnN0IGNvbHM6bnVtYmVyID0gYm9hcmRMYXlvdXRbMF0ubGVuZ3RoXG4gIGNoZWNrZXIucG9zaXRpb24gPSBib2FyZFBvc2l0aW9uVG9QaXhlbHMoYm9hcmRMYXlvdXQsIHNxdWFyZVNpemUsIHN0YXJ0aW5nUG9zaXRpb24pXG4gIGlmKHN0YXJ0aW5nUG9zaXRpb24ueCA8IDAgfHwgc3RhcnRpbmdQb3NpdGlvbi54ID4gcm93cyAtIDEgfHwgc3RhcnRpbmdQb3NpdGlvbi55IDwgMCB8fCBzdGFydGluZ1Bvc2l0aW9uLnkgPiBjb2xzIC0gMSlcbiAgICBjb25zb2xlLmxvZyhcIkZlbGwgb2ZmIHRoZSBib2FyZCFcIiwgc3RhcnRpbmdQb3NpdGlvbi54LCBzdGFydGluZ1Bvc2l0aW9uLnkpXG4gIGVsc2Uge1xuICAgIGNvbnN0IGRpcmVjdGlvbjpESVJFQ1RJT04gPSBib2FyZExheW91dFtzdGFydGluZ1Bvc2l0aW9uLnhdW3N0YXJ0aW5nUG9zaXRpb24ueV1cbiAgICBsZXQgbmV4dFBvc2l0aW9uOlBJWEkuUG9pbnRcbiAgICBzd2l0Y2goZGlyZWN0aW9uKSB7XG4gICAgICBjYXNlIERJUkVDVElPTi5VcDpcbiAgICAgICAgbmV4dFBvc2l0aW9uID0gbmV3IFBJWEkuUG9pbnQoc3RhcnRpbmdQb3NpdGlvbi54IC0gMSwgc3RhcnRpbmdQb3NpdGlvbi55KVxuICAgICAgICBicmVhaztcbiAgICAgIGNhc2UgRElSRUNUSU9OLkRvd246XG4gICAgICAgIG5leHRQb3NpdGlvbiA9IG5ldyBQSVhJLlBvaW50KHN0YXJ0aW5nUG9zaXRpb24ueCArIDEsIHN0YXJ0aW5nUG9zaXRpb24ueSlcbiAgICAgICAgYnJlYWs7XG4gICAgICBjYXNlIERJUkVDVElPTi5MZWZ0OlxuICAgICAgICBuZXh0UG9zaXRpb24gPSBuZXcgUElYSS5Qb2ludChzdGFydGluZ1Bvc2l0aW9uLngsIHN0YXJ0aW5nUG9zaXRpb24ueSAtIDEpXG4gICAgICAgIGJyZWFrO1xuICAgICAgY2FzZSBESVJFQ1RJT04uUmlnaHQ6XG4gICAgICAgIG5leHRQb3NpdGlvbiA9IG5ldyBQSVhJLlBvaW50KHN0YXJ0aW5nUG9zaXRpb24ueCwgc3RhcnRpbmdQb3NpdGlvbi55ICsgMSlcbiAgICAgICAgYnJlYWs7XG4gICAgfVxuICAgIHNldFRpbWVvdXQoKCgpID0+IHBsYXkoY2hlY2tlciwgYm9hcmRMYXlvdXQsIG5leHRQb3NpdGlvbiwgc3F1YXJlU2l6ZSkpLCA1MDApXG4gIH1cbn1cblxuZnVuY3Rpb24gbmV3Qm9hcmRMYXlvdXQocm93cywgY29scyk6bnVtYmVyW11bXSB7XG4gIGNvbnN0IGJvYXJkTGF5b3V0Om51bWJlcltdW10gPSBbXVxuICBmb3IobGV0IHJvdzpudW1iZXIgPSAwIDsgcm93IDwgcm93cyA7IHJvdysrKSB7XG4gICAgYm9hcmRMYXlvdXQucHVzaChbXSlcbiAgICBmb3IobGV0IGNvbDpudW1iZXIgPSAwIDsgY29sIDwgY29scyA7IGNvbCsrKSB7XG4gICAgICBjb25zdCBib2FyZFBvc2l0aW9uOlBJWEkuUG9pbnQgPSBuZXcgUElYSS5Qb2ludChyb3csIGNvbClcbiAgICAgIGNvbnN0IGFyY29sRGlyZWN0aW9uOkRJUkVDVElPTiA9IE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIDQpXG4gICAgICBib2FyZExheW91dFtyb3ddLnB1c2goYXJjb2xEaXJlY3Rpb24pXG4gICAgfVxuICB9XG4gIHJldHVybiBib2FyZExheW91dFxufVxuXG5mdW5jdGlvbiBjcmVhdGVCb2FyZChib2FyZExheW91dDpudW1iZXJbXVtdLCBzcXVhcmVTaXplOm51bWJlcik6UElYSS5Db250YWluZXIge1xuICBjb25zdCByb3dzID0gYm9hcmRMYXlvdXQubGVuZ3RoXG4gIGNvbnN0IGNvbHMgPSBib2FyZExheW91dFswXS5sZW5ndGhcbiAgY29uc3QgZ2FtZUJvYXJkOlBJWEkuQ29udGFpbmVyID0gbmV3IFBJWEkuQ29udGFpbmVyKClcbiAgZ2FtZUJvYXJkLnBvc2l0aW9uID0gbmV3IFBJWEkuUG9pbnQoU0NSRUVOX1dJRFRIIC8gMiwgU0NSRUVOX0hFSUdIVCAvIDIpXG4gIGxldCBldmVuOmJvb2xlYW4gPSBmYWxzZVxuICBnYW1lQm9hcmQucmVtb3ZlQ2hpbGRyZW4oKVxuICBmb3IobGV0IHJvdzpudW1iZXIgPSAwIDsgcm93IDwgcm93cyA7IHJvdysrKSB7XG4gICAgZm9yKGxldCBjb2w6bnVtYmVyID0gMCA7IGNvbCA8IGNvbHMgOyBjb2wrKykge1xuICAgICAgY29uc3QgYm9hcmRQb3NpdGlvbjpQSVhJLlBvaW50ID0gbmV3IFBJWEkuUG9pbnQocm93LCBjb2wpXG4gICAgICBjb25zdCBzcXVhcmU6UElYSS5HcmFwaGljcyA9IGNyZWF0ZVNxdWFyZShzcXVhcmVTaXplLCBldmVuKVxuICAgICAgc3F1YXJlLnBvc2l0aW9uID0gYm9hcmRQb3NpdGlvblRvUGl4ZWxzKGJvYXJkTGF5b3V0LCBzcXVhcmVTaXplLCBib2FyZFBvc2l0aW9uKVxuICAgICAgZ2FtZUJvYXJkLmFkZENoaWxkKHNxdWFyZSlcbiAgICAgIHNxdWFyZS5hZGRDaGlsZChjcmVhdGVBcmNvbChzcXVhcmVTaXplLCBib2FyZExheW91dFtyb3ddW2NvbF0pKVxuICAgICAgZXZlbiA9ICFldmVuXG4gICAgfVxuICAgIGlmKHJvd3MgJSAyID09PSAwKVxuICAgICAgZXZlbiA9ICFldmVuXG4gIH1cbiAgcmV0dXJuIGdhbWVCb2FyZFxufVxuXG5mdW5jdGlvbiBjcmVhdGVTcXVhcmUoc2l6ZTpudW1iZXIsIGV2ZW46Ym9vbGVhbik6UElYSS5HcmFwaGljcyB7XG4gIGNvbnN0IHNxdWFyZTpQSVhJLkdyYXBoaWNzID0gbmV3IFBJWEkuR3JhcGhpY3MoKVxuICBzcXVhcmUuYmVnaW5GaWxsKGV2ZW4gPyByb3dPUl9FVkVOIDogcm93T1JfT0REKVxuICBzcXVhcmUuZHJhd1JlY3QoLXNpemUgLyAyLCAtc2l6ZSAvIDIsIHNpemUsIHNpemUpXG4gIHNxdWFyZS5lbmRGaWxsKClcbiAgcmV0dXJuIHNxdWFyZVxufVxuXG5mdW5jdGlvbiBjcmVhdGVBcmNvbChzaXplOm51bWJlciwgZGlyZWN0aW9uOkRJUkVDVElPTik6UElYSS5HcmFwaGljcyB7XG4gIGNvbnN0IGFyY29sOlBJWEkuR3JhcGhpY3MgPSBuZXcgUElYSS5HcmFwaGljcygpXG4gIGFyY29sLmJlZ2luRmlsbChyb3dPUl9BUmNvbClcbiAgYXJjb2wuZHJhd1JlY3QoLXNpemUgLyAxMiwgLXNpemUgKiAuMiwgc2l6ZSAvIDYsIHNpemUgKiAuNilcbiAgYXJjb2wuZHJhd1BvbHlnb24oW1xuICAgIG5ldyBQSVhJLlBvaW50KDAsIC1zaXplICogLjQpLFxuICAgIG5ldyBQSVhJLlBvaW50KC1zaXplICogLjI1LCAtc2l6ZSAqIC4xKSxcbiAgICBuZXcgUElYSS5Qb2ludChzaXplICogLjI1LCAtc2l6ZSAqIC4xKVxuICBdKVxuICBhcmNvbC5lbmRGaWxsKClcbiAgYXJjb2wucm90YXRpb24gPSBNYXRoLlBJIC8gMiAqIGRpcmVjdGlvblxuICByZXR1cm4gYXJjb2xcbn1cblxuZnVuY3Rpb24gY3JlYXRlQ2hlY2tlcihzaXplOm51bWJlcik6UElYSS5HcmFwaGljcyB7XG4gIGNvbnN0IGNoZWNrZXI6UElYSS5HcmFwaGljcyA9IG5ldyBQSVhJLkdyYXBoaWNzKClcbiAgY2hlY2tlci5hbHBoYSA9IC43NVxuICBjaGVja2VyLmJlZ2luRmlsbChyb3dPUl9DSEVDS0VSKVxuICBjaGVja2VyLmRyYXdDaXJjbGUoMCwgMCwgc2l6ZSAqIC4zKVxuICBjaGVja2VyLmVuZEZpbGwoKVxuICByZXR1cm4gY2hlY2tlclxufVxuXG5mdW5jdGlvbiBib2FyZFBvc2l0aW9uVG9QaXhlbHMoYm9hcmRMYXlvdXQ6bnVtYmVyW11bXSwgc2l6ZTpudW1iZXIsIGJvYXJkUG9zaXRpb246UElYSS5Qb2ludCk6UElYSS5Qb2ludCB7XG4gIHJldHVybiBuZXcgUElYSS5Qb2ludChcbiAgICAoYm9hcmRQb3NpdGlvbi55IC0gYm9hcmRMYXlvdXRbMF0ubGVuZ3RoIC8gMikgKiBzaXplLFxuICAgIChib2FyZFBvc2l0aW9uLnggLSBib2FyZExheW91dC5sZW5ndGggLyAyKSAqIHNpemVcbiAgKVxufVxuXG5mdW5jdGlvbiByYW5kb21Qb3NpdGlvbihib2FyZExheW91dDpudW1iZXJbXVtdKTpQSVhJLlBvaW50IHtcbiAgcmV0dXJuIG5ldyBQSVhJLlBvaW50KFxuICAgICAgTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogYm9hcmRMYXlvdXQubGVuZ3RoKSxcbiAgICAgIE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIGJvYXJkTGF5b3V0WzBdLmxlbmd0aClcbiAgKVxufVxuXG5mdW5jdGlvbiBjbGVhckNvbnRhaW5lcihjb250YWluZXI6UElYSS5Db250YWluZXIpOnZvaWQge1xuICBjb250YWluZXIuY2hpbGRyZW4uZm9yRWFjaChmdW5jdGlvbihjaGlsZDpQSVhJLkRpc3BsYXlPYmplY3QpIHsgY2hpbGQuZGVzdHJveSgpIH0pXG59XG5cbmZ1bmN0aW9uIHJlbmRlckxvb3Aoc3RhZ2U6UElYSS5Db250YWluZXIpOnZvaWQge1xuICAgIC8vIHN0YXJ0IHRoZSB0aW1lciBmb3IgdGhlIG5leHQgYW5pbWF0aW9uIGxvb3BcbiAgICByZXF1ZXN0QW5pbWF0aW9uRnJhbWUoKCkgPT4gcmVuZGVyTG9vcChzdGFnZSkpXG4gICAgLy8gZWFjaCBmcmFtZSB3ZSBzcGluIHRoZSBidW5ueSBhcm91bmQgYSBiaXRcbiAgICAvLyB0aGlzIGlzIHRoZSBtYWluIHJlbmRlciBjYWxsIHRoYXQgbWFrZXMgcGl4aSBkcmF3IHlvdXIgY29udGFpbmVyIGFuZCBpdHMgY2hpbGRyZW4uXG4gICAgcmVuZGVyZXIucmVuZGVyKHN0YWdlKVxufVxuIl19
